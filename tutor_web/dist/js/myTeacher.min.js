!function(){Vue.http.interceptors.push(function(t,s){t.credentials=!0,s()});new Vue({el:"body",data:{domain:"http://shaozi.beansonbar.cn",timer:null,tutorList:[],status:{isTutor:!0,isNoTutor:!1,isTutorInfo:!1,isSuccess:!0,isChangeInfo:!1,isInfoTipOne:!1,selected:"",isRegister:"",isLoading:!1,onParent:!0,onTeacher:!1,isEnlargeImg:!1,enlargeImg:"",errorTip:"对不起，您只能选择一位老师",overY:!1},para:{start:0,size:16},jsonData:[],detailedList:[],form:{selected:"",isRegister:"",isMsg:""}},ready:function(){this.renderData(),this.status.isLoading=!1},methods:{down:function(){this.para.size=5,this.para.start++,0!==this.jsonData.length&&this.renderData()},renderData:function(){this.$http.post(this.domain+"/getOrder",this.para,{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){if(console.log(t.json()),0==t.json().success)console.log(t.json().error);else{this.jsonData=t.json();var s=t.json();if(0!=s.length){for(var i=0;i<s.length;i++)"您已拒绝"==s[i].result||"老师已拒绝"==s[i].result||"通知老师失败"==s[i].result?s[i].isRed=!0:s[i].isRed=!1;var e=this.tutorList.concat(s);this.$set("tutorList",e)}else 0==this.tutorList.length&&(this.status.isTutor=!1,this.status.isNoTutor=!0)}})},onReturn:function(){window.location.href="./parentMyPage.html"},onTutorInfo:function(t){this.status.overY=!0,this.detailedList=[],this.status.isTutorInfo=!0,this.form.selected=t;var s=this.tutorList[t],i=s.result;switch(this.$http.post(this.domain+"/getTeacherInfo",{tea_id:s.tea,format:!0},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){if(console.log(t.json()),0==t.json().success)console.log(t.json().error);else{var i=t.json();""!=i.certificate_photo&&null!=i.certificate_photo&&(i.certificate_photo=this.domain+i.certificate_photo);var e=i.teach_show_photo,o=e.length;if(o>0)for(var n=0;n<o;n++)e[n]=this.domain+e[n];null==s.expectation&&""==s.expectation||(i.expectation=s.expectation),this.detailedList=i}}),this.status.onParent=!0,this.status.onTeacher=!1,this.status.isSuccess=!0,i){case"已成功通知老师":this.form.isRegister="请尽快与老师联系确定试课";break;case"正在通知老师":this.form.isRegister="正在通知老师";break;case"通知老师失败":this.status.isSuccess=!1,this.form.isRegister="请重新选择其他老师";break;case"您已邀请":this.status.isSuccess=!1,this.form.isRegister="取消邀请";break;case"您已拒绝":this.status.isSuccess=!1,this.form.isRegister="您已拒绝该老师";break;case"老师已拒绝":this.form.isRegister="再次邀请该老师";break;case"向您报名":this.status.onParent=!1,this.status.onTeacher=!0}},onRegister1:function(t){if("取消邀请"==this.form.isRegister)this.form.isMsg="邀请",this.status.isTutorInfo=!1,this.status.isChangeInfo=!0;else{if("再次邀请该老师"!=this.form.isRegister)return this.status.overY=!1,this.status.isTutorInfo=!1,!1;this.$http.post(this.domain+"/inviteTeacher",{tea_id:this.tutorList[t].tea,type:1},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(s){if(this.status.overY=!1,console.log(s.json()),1==s.json().success){this.form.isRegister="您已邀请",this.tutorList[t].finish=0;var i=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.tutorList[t].result="您已邀请",i.tutorList[t].isRed=!1,i.status.isTutorInfo=!1},1500)}else{console.log(s.json().error);var i=this;this.status.errorTip=s.json().error,this.status.isTutorInfo=!1,this.status.isInfoTipOne=!0,this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.status.isInfoTipOne=!1},2e3)}})}},onSelect:function(t){this.$http.post(this.domain+"/handleOrder",{type:1,id:this.tutorList[t].tea,accept:1},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(s){if(this.status.overY=!1,1==s.json().success){var i=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.status.isTutorInfo=!1,i.tutorList[t].result="正在通知老师",i.tutorList[t].isRed=!1},1e3)}else console.log(s.json().error)})},onRefuse:function(t){this.$http.post(this.domain+"/handleOrder",{type:1,id:this.tutorList[t].tea,accept:0},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(s){if(console.log(s.json()),this.status.overY=!1,1==s.json().success){var i=this;this.tutorList[t].finish=1,this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.status.isTutorInfo=!1,i.tutorList[t].result="您已拒绝",i.tutorList[t].isRed=!0},1e3)}else console.log(s.json().error)})},onSureChange:function(t){var s=this.form.isMsg;"邀请"==s?this.$http.post(this.domain+"/inviteTeacher",{tea_id:this.tutorList[t].tea,type:0},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(s){if(console.log(s.json()),this.status.overY=!1,1==s.json().success){var i=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.status.isChangeInfo=!1,i.tutorList.splice(t,1)},300)}else console.log(s.json().error)}):this.$http.post(this.domain+"/handleOrder",{type:1,id:this.tutorList[t].tea,accept:0},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(s){this.status.overY=!1,console.log(s.json()),1==s.json().success?(this.status.isChangeInfo=!1,this.tutorList[t].result="您已拒绝",this.tutorList[t].isRed=!0,this.tutorList[t].finish=1):console.log(s.json().error)})},showImg:function(t){this.status.enlargeImg=this.detailedList.teach_show_photo[t],this.status.isEnlargeImg=!0},closeImg:function(){this.status.isEnlargeImg=!1},onClose:function(){this.status.overY=!1,this.status.isChangeInfo=!1,this.status.isTutorInfo=!1,this.status.isInfoTipOne=!1}}})}();