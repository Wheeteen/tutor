!function(){Vue.http.interceptors.push(function(t,s){t.credentials=!0,s()});new Vue({el:"body",data:{timer:null,domain:"http://www.yinzishao.cn/",status:{isParent:!0,isNoParent:!1,isRegister:"",isLoading:!1,myInfo:!1,isTutorInfo:!1,isDefault:"",isSuccess:"",expection:!1,isSubmit:!1,isInfoTipOne:!1,noExpection:"",errorTip:"对不起，您还未通过审核"},msgList:[],detailedList:[],para:{size:9,start:0},jsonData:[],form:{selected:"",expection:""},location:{latitude:"",longitude:""},signature:""},computed:{remindSubmit:function(){return""!==this.form.expection&&null!=this.form.expection}},ready:function(){this.getData(),this.status.isLoading=!0},methods:{down:function(){this.para.size=5,this.para.start++,console.log(this.jsonData),0!==this.jsonData.length&&this.getData()},getData:function(){var t=this;this.$http.post(this.domain+"getParentOrder",this.para,{crossOrigin:!0,headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(function(s){if(console.log(s.json()),0==s.json().success)console.log(s.json().error);else{this.jsonData=s.json();var i=s.json();if(0!=i.length){for(var e=0;e<i.length;e++){var n=this.grade_level(i[e].class_field);i[e].class_field=n,"您已拒绝"==i[e].isInvited||"家长已拒绝"==i[e].isInvited?i[e].isRed=!0:i[e].isRed=!1}var o=t.msgList.concat(i);this.$set("msgList",o)}else 0==this.msgList.length&&(this.status.isParent=!1,this.status.isNoParent=!0)}})},grade_level:function(t){switch(t){case 0:return"";case 1:return"较为靠后";case 2:return"中等偏下";case 3:return"中等水平";case 4:return"中上水平";case 5:return"名列前茅"}},getSignature:function(){this.$http.post(this.domain+"/generate_signature",{timestamp:1482652615,nonceStr:"yinzishao"},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){if(console.log(t.json()),1==t.json().success){this.signature=t.json().signature;var s=this;wx.config({debug:!0,appId:"wx6fe7f0568b75d925",timestamp:1482652615,nonceStr:"yinzishao",signature:s.signature,jsApiList:["getLocation","openLocation"]}),s.onAllow()}else console.log(t.json().error)})},sendLocation:function(){this.$http.post(this.domain+"/setLocations",this.location,{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(t){1==t.json().success&&(this.status.getLocation=!1)})},setLocation:function(){this.getSignature()},onAllow:function(){var t=this;wx.getLocation({type:"wgs84",success:function(s){alert(JSON.stringify(s)),t.location.latitude=s.latitude,t.location.longitude=s.longitude,t.sendLocation(),console.log("latitude : "+t.location.latitude+"--longitude : "+t.location.longitude)}})},onRecommend:function(){this.status.tutorList=!0,this.status.myInfo=!1},onMine:function(){window.location.href="./teacherMyPage.html"},onTutorInfo:function(t){switch(this.form.selected=t,this.status.isTutorInfo=!0,this.status.isDefault=!1,this.status.isSuccess=!0,this.detailedList=this.msgList[t],this.detailedList.isInvited){case"您已报名":this.status.isDefault=!0,this.status.isSuccess=!1,this.status.isRegister="取消报名";break;case"对方已邀请":this.status.isRegister="该家长已邀请";break;case"对方已同意":this.status.isRegister="该家长已同意";break;case"您已拒绝":this.status.isDefault=!0,this.status.isSuccess=!1,this.status.isRegister="您已拒绝该家长";break;case"家长已拒绝":this.status.isDefault=!0,this.status.isSuccess=!1,this.status.isRegister="该家长已拒绝";break;case"请上传截图":this.status.isRegister="请到“我的订单”上传截图";break;case"管理员审核中":this.status.isRegister="管理员审核中";break;case"已成交":this.status.isRegister="双方已成交";break;case"":this.status.isRegister="报名"}},onClose:function(){this.status.isTutorInfo=!1},onRegister:function(t){if("取消报名"==this.status.isRegister)this.$http.post(this.domain+"applyParent",{pd_id:this.msgList[t].pd_id,type:0},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(s){if(console.log(s.json()),1==s.json().success){this.status.isRegister="取消成功";var i=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.msgList[t].isInvited="",i.status.isTutorInfo=!1},1e3)}else conosle.log(s.json().error)});else{if("报名"!=this.status.isRegister)return this.status.isTutorInfo=!1,!1;this.status.isTutorInfo=!1,this.status.expection=!0}},onApply:function(t){return""!=this.form.expection&&null!=this.form.expection&&(this.status.isSubmit=!0,void this.$http.post(this.domain+"applyParent",{pd_id:this.msgList[t].pd_id,expectation:this.form.expection,type:1},{crossOrigin:!0,headers:{"Content-Type":"application/json"}}).then(function(s){console.log(s.json());var i=this;this.status.isSubmit=!1,1==s.json().success?(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.msgList[t].isInvited="您已报名",i.status.expection=!1,i.form.expection=""},1e3)):(console.log(s.json().error),this.status.errorTip=s.json().error,this.status.isTutorInfo=!1,this.status.isInfoTipOne=!0,this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.status.isInfoTipOne=!1},2e3))}))},onCloseExp:function(){this.status.expection=!1}}})}();